<br />
<br />
<div nz-row>
  <h1 *ngIf="!isUserRole(['Admin', 'HRManagement', 'HRUser', 'Recruiter'])" class="headerFont">Hello and Welcome {{currentUser.firstName}}!</h1>
</div>
<br />
<div class="proximanova-r">
  <div class="row">
    <nz-tabset [(nzSelectedIndex)]="tabIndex" [nzTabBarExtraContent]="extraContent()">
      <nz-tab nzTitle="{{referralsListTabTitle}}">
        <app-referrals-list 
        (editEvent)="showContactReferralModal($event)" 
        [communities]="communities"
        (deleteEvent)="deleteReferral($event)"></app-referrals-list>              
      </nz-tab>
      <nz-tab nzTitle="OPEN POSITIONS" (nzClick)="getOpenPositions()">
        <app-open-positions
        [positionsDisplayData]="openPositions"
        [communities]="communities"
        [filteredPositions]="openPositions"      
        (showDeleteConfirm)="deletePositionConfirm($event)"
        (showEdit)="showEditPositionModal($event)"
        (position)="apply($event)"
        (jobInfo)="showJobDescription($event,jobDescription)"
        (radioClick)="priorityChange($event)">        
        </app-open-positions>
      </nz-tab>
    </nz-tabset>
    <ng-template #newReferralsButton>
      <button *ngIf="!checkHrRole()" class="referralsButton" nz-button (click)="showContactCandidatesModal(newCandidate)">NEW REFERRAL</button>
    </ng-template>
    <ng-template #newPositionButton>
      <button class="referralsButton" nz-button (click)="showOpenPositionModal(newPosition)">ADD POSITION</button>
    </ng-template>
  </div>
</div>

<ng-template #candidateDetailModal>
  <candidate-details [_detailedCandidate]="emptyCandidate"></candidate-details>
</ng-template>

<ng-template #userDetailModal>
  <user-details [_detailedUser]="emptyUser"></user-details>
</ng-template>

<ng-template #rejectProcessModal>
  <form nz-form [formGroup]="rejectProcessForm" [nzLayout]="'horizontal'">
    <nz-form-item>
      <div nz-row>
        <div nz-col nzSpan="24">
          <nz-form-label [nzSm]="9" [nzXs]="24" nzFor="type">Rejection reason</nz-form-label>
        </div>
      </div>
      <div nz-row>
        <div nz-col nzSpan="24">
          <nz-form-control [nzSm]="22" [nzXs]="24" [nzErrorTip]="rejectionReasonErrorMsg">
            <textarea rows="5" id="rejectionReasonDescription" nz-input formControlName="rejectionReasonDescription"
              placeholder="Please enter reason of rejection"></textarea>
            <ng-template #rejectionReasonErrorMsg>
              <ng-container
                *ngIf="rejectProcessForm.get('rejectionReasonDescription').dirty && rejectProcessForm.get('rejectionReasonDescription').errors">
                Please specify why the process is rejected
              </ng-container>
            </ng-template>
          </nz-form-control>
        </div>
      </div>
    </nz-form-item>
  </form>
</ng-template>

<ng-template #processStart>
  <div nz-col nzSpan="24">
    <nz-steps [nzCurrent]="stepIndex">
      <nz-step nzTitle="Candidate" id="candidateButton"
        (click)="slickModal.slickGoTo(0);wishedStage(0, $event.currentTarget.id)">
      </nz-step>
      <nz-step nzTitle="HR" id="hrButton" (click)="slickModal.slickGoTo(1);wishedStage(1, $event.currentTarget.id)">
      </nz-step>
      <nz-step nzTitle="Technical" id="technicalButton"
        (click)="slickModal.slickGoTo(2);wishedStage(2, $event.currentTarget.id)">
      </nz-step>
      <nz-step *ngIf="isUserRole(['Admin', 'HRManagement', 'HRUser'])" nzTitle="Client" id="clientButton"
        (click)="slickModal.slickGoTo(2);wishedStage(2, $event.currentTarget.id)"></nz-step>
      <nz-step *ngIf="isUserRole(['Admin', 'HRManagement', 'HRUser'])" nzTitle="Offer" id="prePreOfferButton"
        (click)="slickModal.slickGoTo(3);wishedStage(3, $event.currentTarget.id)"></nz-step>
      <nz-step *ngIf="isUserRole(['Admin', 'HRManagement', 'HRUser'])" nzTitle="Offer" id="PreOfferButton"
        (click)="slickModal.slickGoTo(4);wishedStage(4, $event.currentTarget.id)"></nz-step>
    </nz-steps>
  </div>
  <br />
  <br />
  <ngx-slick-carousel #slickModal class="carousel" [config]="slideConfig" (destroy)="closeModal()">
    <div ngxSlickItem class="slide">
      <candidate-add [_candidateProfiles]=profiles [_communities]=communities [_process]="emptyProcess" [_users]="users"
        [_candidate]="currentCandidate" [_offices]="offices">
      </candidate-add>
    </div>
    <div ngxSlickItem class="slide">
      <hr-stage [_users]="users" [hrStage]="emptyProcess.hrStage"></hr-stage>
    </div>
    <div ngxSlickItem class="slide" style="overflow-y: auto; height: 512px">
      <technical-stage [_process]="emptyProcess" [_users]="users" [technicalStage]="emptyProcess.technicalStage"
        (selectedSeniority)="updateSeniority($event)"></technical-stage>
    </div>
    <div ngxSlickItem class="slide">
      <client-stage [_users]="users" [clientStage]="emptyProcess.clientStage"></client-stage>
    </div>
    <div ngxSlickItem class="slide" style="overflow-y: auto; height: 565px">
      <offer-stage [_users]="users" [offerStage]="emptyProcess.offerStage"
        (selectedSeniority)="updateSeniority($event)"></offer-stage>
    </div>
  </ngx-slick-carousel>
</ng-template>

<ng-template #startModalButtons>
  <div nz-row>
    <button nz-button nzType="default" (click)="closeModal()">Cancel</button>
    <button nz-button nzType="primary" (click)="saveProcess()">Save</button>
  </div>
</ng-template>

<ng-template #newCandidate>
  <app-referrals-contact [position]=currentPosition [_visible]=true [communities]=communities></app-referrals-contact>
</ng-template>

<ng-template #newPosition>
  <app-position-add [_communities]=communities></app-position-add>
</ng-template>

<ng-template #jobDescription>
  <div class="jobDescription">
    <app-text-editor [setContent]="jobDescriptionContent"></app-text-editor>
  </div>
</ng-template>
